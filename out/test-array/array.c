/* 
  This file was generated by KaRaMeL <https://github.com/FStarLang/karamel>

  F* version: <unknown>

 */

#include "array.h"

#include "Eurydice.h"

uint8_t array_fun(Eurydice_slice x)
{
  return
    Eurydice_slice_index(Eurydice_array_to_subslice3(Eurydice_slice_index(x,
          (size_t)0U,
          uint8_t [32U],
          uint8_t (*)[32U]),
        (size_t)0U,
        (size_t)1U,
        uint8_t *),
      (size_t)0U,
      uint8_t,
      uint8_t *);
}

array_Foo array_mk_foo(void)
{
  uint32_t x[2U] = { 0U };
  uint32_t y[2U];
  for (uint32_t _i = 0U; _i < (size_t)2U; ++_i)
    y[_i] = 1U;
  /* Passing arrays by value in Rust generates a copy in C */
  uint32_t copy_of_x[2U];
  memcpy(copy_of_x, x, (size_t)2U * sizeof (uint32_t));
  /* Passing arrays by value in Rust generates a copy in C */
  uint32_t copy_of_y[2U];
  memcpy(copy_of_y, y, (size_t)2U * sizeof (uint32_t));
  array_Foo lit;
  memcpy(lit.x, copy_of_x, (size_t)2U * sizeof (uint32_t));
  memcpy(lit.y, copy_of_y, (size_t)2U * sizeof (uint32_t));
  return lit;
}

array_Foo array_mk_foo2(void)
{
  return array_mk_foo();
}

void array_mut_array(uint32_t x[2U])
{
  x[0U] = 1U;
}

void array_mut_foo(array_Foo f)
{
  f.x[0U] = 1U;
  uint32_t copy[2U];
  memcpy(copy, f.y, (size_t)2U * sizeof (uint32_t));
  copy[0U] = 0U;
}

typedef struct _uint32_t__x2_s
{
  uint32_t *fst;
  uint32_t *snd;
}
_uint32_t__x2;

void array_main(void)
{
  /* XXX1 */
  array_Foo uu____0 = array_mk_foo2();
  uint32_t x[2U];
  memcpy(x, uu____0.x, (size_t)2U * sizeof (uint32_t));
  /* XXX2
    XXX3 */
  uint32_t y[2U];
  memcpy(y, uu____0.y, (size_t)2U * sizeof (uint32_t));
  uint32_t unsigned0 = 0U;
  uint32_t uu____1[2U];
  memcpy(uu____1, x, (size_t)2U * sizeof (uint32_t));
  array_mut_array(uu____1);
  /* Passing arrays by value in Rust generates a copy in C */
  uint32_t copy_of_x[2U];
  memcpy(copy_of_x, x, (size_t)2U * sizeof (uint32_t));
  /* Passing arrays by value in Rust generates a copy in C */
  uint32_t copy_of_y[2U];
  memcpy(copy_of_y, y, (size_t)2U * sizeof (uint32_t));
  array_Foo lit;
  memcpy(lit.x, copy_of_x, (size_t)2U * sizeof (uint32_t));
  memcpy(lit.y, copy_of_y, (size_t)2U * sizeof (uint32_t));
  array_mut_foo(lit);
  _uint32_t__x2 uu____4 = { .fst = x, .snd = &unsigned0 };
  EURYDICE_ASSERT(uu____4.fst[0U] == uu____4.snd[0U], "panic!");
}

