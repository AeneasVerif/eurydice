/* 
  This file was generated by KaRaMeL <https://github.com/FStarLang/karamel>

  F* version: <unknown>

 */

#include "more_primitive_types.h"

#include "internal/Eurydice.h"

int32_t more_primitive_types_int128_operations(more_primitive_types_MorePrimitiveTypes *p)
{
  Eurydice_int128_t uu____0 = p->int128;
  Eurydice_int128_t
  uu____1 =
    Eurydice_i128_mul(Eurydice_i128_from_bits(0x0ULL, 0x1ffffffffffffffULL),
      Eurydice_i128_from_bits(0x0ULL, 0x1ULL));
  Eurydice_int128_t
  uu____2 =
    Eurydice_i128_shl(Eurydice_i128_sub(Eurydice_i128_from_bits(0x0ULL, 0xffffffff1ULL), uu____1),
      10U);
  p->int128 = Eurydice_i128_band(uu____0, uu____2);
  Eurydice_uint128_t uu____3 = p->uint128;
  Eurydice_uint128_t
  uu____4 =
    Eurydice_u128_sub(Eurydice_u128_from_bits(0x0ULL, 0xffffffff1ULL),
      Eurydice_u128_from_bits(0x0ULL, 0x1fULL));
  p->uint128 = Eurydice_u128_band(uu____3, uu____4);
  Eurydice_uint128_t uu____5 = p->uint128;
  Eurydice_uint128_t
  uu____6 = Eurydice_u128_shr(Eurydice_u128_from_bits(0x0ULL, 0x1ULL), (uint32_t)uu____5);
  Eurydice_uint128_t x = Eurydice_u128_shl(uu____6, (uint32_t)p->int128);
  return (int32_t)x;
}

int32_t more_primitive_types_match_u128(more_primitive_types_MorePrimitiveTypes *p)
{
  if
  (
    !(Eurydice_u128_eq(p->uint128, Eurydice_u128_from_bits(0x0ULL, 0xffffULL)) ||
      Eurydice_u128_eq(p->uint128,
        Eurydice_u128_from_bits(0x0ULL, 0xffffffffULL)))
  )
  {
    if
    (
      Eurydice_u128_eq(p->uint128,
        Eurydice_u128_from_bits(0xffffffffffffULL, 0xffffffffffffffffULL))
    )
    {
      return (int32_t)4;
    }
    else if
    (
      Eurydice_u128_eq(p->uint128,
        Eurydice_u128_from_bits(0xffffffffffffffffULL, 0xffffffffffffffffULL))
    )
    {
      return (int32_t)5;
    }
    else
    {
      return (int32_t)1;
    }
  }
  return (int32_t)3;
}

int32_t more_primitive_types_match_i128(more_primitive_types_MorePrimitiveTypes *p)
{
  if
  (
    !(Eurydice_i128_eq(p->int128,
      Eurydice_i128_from_bits(0xffffffffffffffffULL, 0xffffffffffff0001ULL))
    ||
      Eurydice_i128_eq(p->int128,
        Eurydice_i128_from_bits(0xffffffffffffffffULL, 0xffffffff00000001ULL)))
  )
  {
    if (Eurydice_i128_eq(p->int128, Eurydice_i128_from_bits(0xffffffffffffffffULL, 0x1ULL)))
    {
      return (int32_t)4;
    }
    else if (Eurydice_i128_eq(p->int128, Eurydice_i128_from_bits(0xfffff00000000000ULL, 0x1ULL)))
    {
      return (int32_t)5;
    }
    else
    {
      return (int32_t)1;
    }
  }
  return (int32_t)3;
}

void more_primitive_types_use_more_primitive_types(void)
{
  uint8_t s[6U] = { 97U, 104U, 101U, 108U, 108U, 111U };
  more_primitive_types_MorePrimitiveTypes
  p =
    {
      .int128 = Eurydice_i128_from_bits(0xfffff00000000000ULL, 0x1ULL),
      .uint128 = Eurydice_u128_from_bits(0xffffffffffffULL, 0xffffffffffffffffULL),
      .c = 97U
    };
  LowStar_Ignore_ignore(more_primitive_types_match_u128(&p), int32_t, void *);
  LowStar_Ignore_ignore(more_primitive_types_match_i128(&p), int32_t, void *);
  EURYDICE_ASSERT(p.c == (uint32_t)s[0U], "panic!");
}

void more_primitive_types_main(void)
{
  more_primitive_types_use_more_primitive_types();
}

